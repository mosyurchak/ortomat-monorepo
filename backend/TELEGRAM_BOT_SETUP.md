# –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Telegram –ë–æ—Ç–∞ –¥–ª—è –õ—ñ–∫–∞—Ä—ñ–≤-–†–µ—Ñ–µ—Ä–∞–ª—ñ–≤

–¶–µ–π –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—É—î —è–∫ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ Telegram –±–æ—Ç–∞ –¥–ª—è —Å–∏—Å—Ç–µ–º–∏ —Ä–µ—Ñ–µ—Ä–∞–ª—ñ–≤ Ortomat.

## –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ –ë–æ—Ç–∞

- üìä –ü–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –±–∞–ª—ñ–≤ —Ç–∞ –ø—Ä–æ–¥–∞–∂—ñ–≤
- üí∞ –ú–∏—Ç—Ç—î–≤—ñ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –∫–æ–∂–µ–Ω –Ω–æ–≤–∏–π –ø—Ä–æ–¥–∞–∂
- üîó –ü—Ä–∏–≤'—è–∑–∫–∞ Telegram –∞–∫–∞—É–Ω—Ç—É –¥–æ –ø—Ä–æ—Ñ—ñ–ª—é –ª—ñ–∫–∞—Ä—è
- üìà –Ü—Å—Ç–æ—Ä—ñ—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö 5 –ø—Ä–æ–¥–∞–∂—ñ–≤

## –ö—Ä–æ–∫ 1: –°—Ç–≤–æ—Ä–µ–Ω–Ω—è Telegram –ë–æ—Ç–∞

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ Telegram —Ç–∞ –∑–Ω–∞–π–¥—ñ—Ç—å [@BotFather](https://t.me/BotFather)
2. –ù–∞–¥—ñ—à–ª—ñ—Ç—å –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `Ortomat Referral Bot`)
4. –í–≤–µ–¥—ñ—Ç—å username –±–æ—Ç–∞ (–º–∞—î –∑–∞–∫—ñ–Ω—á—É–≤–∞—Ç–∏—Å—è –Ω–∞ `bot`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥: `ortomat_referral_bot`)
5. BotFather –Ω–∞–¥–∞—Å—Ç—å –≤–∞–º **—Ç–æ–∫–µ–Ω** - –∑–±–µ—Ä–µ–∂—ñ—Ç—å –π–æ–≥–æ!

–ü—Ä–∏–∫–ª–∞–¥ —Ç–æ–∫–µ–Ω—É: `1234567890:ABCdefGHIjklMNOpqrsTUVwxyz`

## –ö—Ä–æ–∫ 2: –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è Backend

### 1. –î–æ–¥–∞–π—Ç–µ —Ç–æ–∫–µ–Ω –≤ `.env`

```bash
TELEGRAM_BOT_TOKEN="–≤–∞—à_—Ç–æ–∫–µ–Ω_–≤—ñ–¥_BotFather"
```

### 2. –ó–∞—Å—Ç–æ—Å—É–π—Ç–µ –º—ñ–≥—Ä–∞—Ü—ñ—é –±–∞–∑–∏ –¥–∞–Ω–∏—Ö

```bash
cd backend
npx prisma migrate deploy
# –∞–±–æ
npx prisma migrate dev
```

–¶–µ –¥–æ–¥–∞—Å—Ç—å –ø–æ–ª—è `telegramChatId`, `telegramUsername` —Ç–∞ `telegramNotifications` –¥–æ —Ç–∞–±–ª–∏—Ü—ñ `users`.

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç—ñ—Ç—å backend

```bash
npm run start:dev
```

–í–∏ –º–∞—î—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ –≤ –ª–æ–≥–∞—Ö:
```
‚úÖ Telegram –±–æ—Ç —É—Å–ø—ñ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω–æ
‚úÖ –ö–æ–º–∞–Ω–¥–∏ –±–æ—Ç–∞ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ
```

## –ö—Ä–æ–∫ 3: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ë–æ—Ç–∞ (–¥–ª—è –õ—ñ–∫–∞—Ä—ñ–≤)

### –ü—Ä–∏–≤'—è–∑–∫–∞ Telegram –¥–æ –û–±–ª—ñ–∫–æ–≤–æ–≥–æ –ó–∞–ø–∏—Å—É

1. –ó–Ω–∞–π–¥—ñ—Ç—å –≤–∞—à–æ–≥–æ –±–æ—Ç–∞ –≤ Telegram (–∑–∞ username)
2. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å `/start`
3. –í–∏–∫–æ–Ω–∞–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/link` –∑ –≤–∞—à–∏–º email:
   ```
   /link doctor@example.com
   ```
4. –ë–æ—Ç –ø—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å —É—Å–ø—ñ—à–Ω—É –ø—Ä–∏–≤'—è–∑–∫—É ‚úÖ

### –î–æ—Å—Ç—É–ø–Ω—ñ –ö–æ–º–∞–Ω–¥–∏

#### `/start`
–ü–æ—á–∞—Ç–æ–∫ —Ä–æ–±–æ—Ç–∏ –∑ –±–æ—Ç–æ–º, –ø–æ–∫–∞–∑—É—î —ñ–Ω—Å—Ç—Ä—É–∫—Ü—ñ—ó

#### `/link <email>`
–ü—Ä–∏–≤'—è–∑—É—î Telegram –∞–∫–∞—É–Ω—Ç –¥–æ –ø—Ä–æ—Ñ—ñ–ª—é –ª—ñ–∫–∞—Ä—è

**–ü—Ä–∏–∫–ª–∞–¥:**
```
/link mykola.petrenko@gmail.com
```

#### `/stats`
–ü–æ–∫–∞–∑—É—î –ø–æ—Ç–æ—á–Ω—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:
- –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–∞–ª—ñ–≤
- –í—Å—å–æ–≥–æ –ø—Ä–æ–¥–∞–∂—ñ–≤
- –û—Å—Ç–∞–Ω–Ω—ñ 5 –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑ –±–∞–ª–∞–º–∏ —Ç–∞ –¥–∞—Ç–∞–º–∏

**–ü—Ä–∏–∫–ª–∞–¥ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:**
```
üìä –í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

üë§ –ú–∏–∫–æ–ª–∞ –ü–µ—Ç—Ä–µ–Ω–∫–æ
üè™ –û—Ä—Ç–æ–º–∞—Ç: –ê–ø—Ç–µ–∫–∞ ‚Ññ1
üìç –≤—É–ª. –•—Ä–µ—â–∞—Ç–∏–∫, 1

üí∞ –ó–∞–≥–∞–ª—å–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –±–∞–ª—ñ–≤: 450
üì¶ –í—Å—å–æ–≥–æ –ø—Ä–æ–¥–∞–∂—ñ–≤: 15

üïê –û—Å—Ç–∞–Ω–Ω—ñ 5 –ø—Ä–æ–¥–∞–∂—ñ–≤:
1. –û—Ä—Ç–æ–ø–µ–¥–∏—á–Ω—ñ —É—Å—Ç—ñ–ª–∫–∏ - 30 –±–∞–ª—ñ–≤ (25.01.2026)
2. –ö–æ–º–ø—Ä–µ—Å—ñ–π–Ω—ñ –ø–∞–Ω—á–æ—Ö–∏ - 25 –±–∞–ª—ñ–≤ (23.01.2026)
3. –ë–∞–Ω–¥–∞–∂ - 20 –±–∞–ª—ñ–≤ (20.01.2026)
...
```

#### `/unlink`
–í—ñ–¥–≤'—è–∑—É—î Telegram –≤—ñ–¥ –æ–±–ª—ñ–∫–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É

#### `/help`
–ü–æ–∫–∞–∑—É—î —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –∫–æ–º–∞–Ω–¥

## –°–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –ü—Ä–æ–¥–∞–∂—ñ

–ö–æ–∂–µ–Ω —Ä–∞–∑ –∫–æ–ª–∏ –∫–ª—ñ—î–Ω—Ç –∫—É–ø—É—î —Ç–æ–≤–∞—Ä —á–µ—Ä–µ–∑ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–µ –ø–æ—Å–∏–ª–∞–Ω–Ω—è –ª—ñ–∫–∞—Ä—è, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –Ω–∞–¥—Å–∏–ª–∞—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:

```
üéâ –ù–æ–≤–∏–π –ø—Ä–æ–¥–∞–∂!

üì¶ –¢–æ–≤–∞—Ä: –û—Ä—Ç–æ–ø–µ–¥–∏—á–Ω—ñ —É—Å—Ç—ñ–ª–∫–∏
üí∞ –û—Ç—Ä–∏–º–∞–Ω–æ –±–∞–ª—ñ–≤: +30
üìä –í—Å—å–æ–≥–æ –±–∞–ª—ñ–≤: 480
üíµ –°—É–º–∞ –ø—Ä–æ–¥–∞–∂—É: 850 –≥—Ä–Ω

–í—ñ—Ç–∞—î–º–æ! üéä
```

## –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ù–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π

–Ø–∫—â–æ –ª—ñ–∫–∞—Ä —Ö–æ—á–µ –≤–∏–º–∫–Ω—É—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, –≤—ñ–Ω –º–æ–∂–µ:
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É `/unlink` —â–æ–± –ø–æ–≤–Ω—ñ—Å—Ç—é –≤—ñ–¥–≤'—è–∑–∞—Ç–∏ Telegram
- –ê–±–æ –≤ –º–∞–π–±—É—Ç–Ω—å–æ–º—É –±—É–¥–µ –¥–æ–¥–∞–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ `/notifications off`

## –ë–µ–∑–ø–µ–∫–∞

### –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ù–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –î–æ—Å—Ç—É–ø—É

- –¢—ñ–ª—å–∫–∏ –ª—ñ–∫–∞—Ä—ñ (–∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ –∑ —Ä–æ–ª–ª—é `DOCTOR`) –º–æ–∂—É—Ç—å –ø—Ä–∏–≤'—è–∑–∞—Ç–∏ Telegram
- Email –º–∞—î —ñ—Å–Ω—É–≤–∞—Ç–∏ –≤ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö
- –û–¥–∏–Ω Telegram –º–æ–∂–µ –±—É—Ç–∏ –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π —Ç—ñ–ª—å–∫–∏ –¥–æ –æ–¥–Ω–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É
- –ü—Ä–∏ —Å–ø—Ä–æ–±—ñ –ø—Ä–∏–≤'—è–∑–∞—Ç–∏ –¥–æ –≤–∂–µ –∑–∞–π–Ω—è—Ç–æ–≥–æ –∞–∫–∞—É–Ω—Ç—É - –±–æ—Ç –≤—ñ–¥—Ö–∏–ª–∏—Ç—å –∑–∞–ø–∏—Ç

### –ü—Ä–∏–≤–∞—Ç–Ω—ñ—Å—Ç—å –î–∞–Ω–∏—Ö

- –ë–æ—Ç –ù–ï –∑–±–µ—Ä—ñ–≥–∞—î —ñ—Å—Ç–æ—Ä—ñ—é –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å
- –ë–æ—Ç –ù–ï –º–∞—î –¥–æ—Å—Ç—É–ø—É –¥–æ –æ—Å–æ–±–∏—Å—Ç–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
- –ó–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ `chatId` —Ç–∞ `username` –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π

## Troubleshooting

### –ë–æ—Ç –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î

1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ `TELEGRAM_BOT_TOKEN` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ –≤ `.env`
2. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ backend –∑–∞–ø—É—â–µ–Ω–æ
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ backend –Ω–∞ –ø–æ–º–∏–ª–∫–∏

### –ö–æ–º–∞–Ω–¥–∞ /link –Ω–µ –ø—Ä–∞—Ü—é—î

1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ email –Ω–∞–ø–∏—Å–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á —ñ—Å–Ω—É—î –≤ –ë–î
3. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ —â–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î —Ä–æ–ª—å `DOCTOR`

### –ù–µ –ø—Ä–∏—Ö–æ–¥—è—Ç—å –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ø—Ä–æ –ø—Ä–æ–¥–∞–∂—ñ

1. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ Telegram –ø—Ä–∏–≤'—è–∑–∞–Ω–∏–π (`/stats` –º–∞—î –ø—Ä–∞—Ü—é–≤–∞—Ç–∏)
2. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ backend –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –ø–ª–∞—Ç–µ–∂—É
3. –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Ç–µ—Å—è —â–æ `telegramNotifications = true` –≤ –ë–î

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### Backend –ú–æ–¥—É–ª—ñ

```
src/
  telegram-bot/
    telegram-bot.module.ts    # NestJS –º–æ–¥—É–ª—å
    telegram-bot.service.ts   # –õ–æ–≥—ñ–∫–∞ –±–æ—Ç–∞ —Ç–∞ –∫–æ–º–∞–Ω–¥–∏
```

### –Ü–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—è –∑ –ü–ª–∞—Ç–µ–∂–∞–º–∏

**LiqPay:**
- `liqpay.service.ts` ‚Üí –≤–∏–∫–ª–∏–∫–∞—î `telegramBotService.sendSaleNotification()`

**Monobank:**
- `mono-payment.service.ts` ‚Üí –≤–∏–∫–ª–∏–∫–∞—î `telegramBotService.sendSaleNotification()`

### –ë–∞–∑–∞ –î–∞–Ω–∏—Ö

–î–æ–¥–∞–Ω—ñ –ø–æ–ª—è –≤ —Ç–∞–±–ª–∏—Ü—é `users`:
```prisma
model User {
  // ...
  telegramChatId           String?  @unique
  telegramUsername         String?
  telegramNotifications    Boolean  @default(true)
  // ...
}
```

## API –ú–µ—Ç–æ–¥–∏ (–¥–ª—è —Ä–æ–∑—Ä–æ–±–Ω–∏–∫—ñ–≤)

### TelegramBotService

```typescript
// –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è –ø—Ä–æ –ø—Ä–æ–¥–∞–∂
await telegramBotService.sendSaleNotification(doctorId, {
  productName: '–û—Ä—Ç–æ–ø–µ–¥–∏—á–Ω—ñ —É—Å—Ç—ñ–ª–∫–∏',
  points: 30,
  totalPoints: 480,
  amount: 850,
});

// –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∫–∞—Å—Ç–æ–º–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
await telegramBotService.sendMessage(chatId, '–í–∞—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è');
```

## –ú–∞–π–±—É—Ç–Ω—ñ –ü–æ–∫—Ä–∞—â–µ–Ω–Ω—è

- [ ] –î–æ–¥–∞—Ç–∏ –∫–æ–º–∞–Ω–¥—É `/notifications on/off` –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–æ—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ–π
- [ ] –î–æ–¥–∞—Ç–∏ –≥—Ä–∞—Ñ—ñ–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- [ ] –î–æ–¥–∞—Ç–∏ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –µ–∫—Å–ø–æ—Ä—Ç—É –∑–≤—ñ—Ç—ñ–≤ –≤ PDF
- [ ] Webhook —Ä–µ–∂–∏–º –∑–∞–º—ñ—Å—Ç—å polling –¥–ª—è production
- [ ] –Ü–Ω–ª–∞–π–Ω-–∫–Ω–æ–ø–∫–∏ –¥–ª—è —à–≤–∏–¥–∫–∏—Ö –¥—ñ–π

## –ü—ñ–¥—Ç—Ä–∏–º–∫–∞

–Ø–∫—â–æ –≤–∏–Ω–∏–∫–ª–∏ –ø–∏—Ç–∞–Ω–Ω—è –∞–±–æ –ø—Ä–æ–±–ª–µ–º–∏:
1. –ü–µ—Ä–µ–≤—ñ—Ä—Ç–µ –ª–æ–≥–∏ backend
2. –ü–µ—Ä–µ–≥–ª—è–Ω—å—Ç–µ —Ü–µ–π –¥–æ–∫—É–º–µ–Ω—Ç
3. –ó–≤–µ—Ä–Ω—ñ—Ç—å—Å—è –¥–æ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–∏—Å—Ç–µ–º–∏
